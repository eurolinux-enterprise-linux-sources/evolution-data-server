diff -up evolution-data-server-2.32.3/camel/camel-gpg-context.c.CVE-2013-4166 evolution-data-server-2.32.3/camel/camel-gpg-context.c
--- evolution-data-server-2.32.3/camel/camel-gpg-context.c.CVE-2013-4166	2013-07-31 14:03:53.707635522 +0200
+++ evolution-data-server-2.32.3/camel/camel-gpg-context.c	2013-07-31 14:03:59.556635122 +0200
@@ -339,13 +339,25 @@ gpg_ctx_set_userid (struct _GpgCtx *gpg,
 static void
 gpg_ctx_add_recipient (struct _GpgCtx *gpg, const gchar *keyid)
 {
+	gchar *safe_keyid;
+
 	if (gpg->mode != GPG_CTX_MODE_ENCRYPT && gpg->mode != GPG_CTX_MODE_EXPORT)
 		return;
 
 	if (!gpg->recipients)
 		gpg->recipients = g_ptr_array_new ();
 
-	g_ptr_array_add (gpg->recipients, g_strdup (keyid));
+	g_return_if_fail (keyid != NULL);
+
+	/* If the recipient looks like an email address,
+	 * enclose it in brackets to ensure an exact match. */
+	if (strchr (keyid, '@') != NULL) {
+		safe_keyid = g_strdup_printf ("<%s>", keyid);
+	} else {
+		safe_keyid = g_strdup (keyid);
+	}
+
+	g_ptr_array_add (gpg->recipients, safe_keyid);
 }
 
 static void
